<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Price of College in the US</title>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="https://d3js.org/topojson.v1.min.js"></script>
    <style>
        .state {
            fill: #ccc;
            stroke: #333;
            stroke-width: 0.5px;
        }

        .tooltip {
            position: absolute;
            text-align: center;
            padding: 4px;
            background: lightgray;
            border: 1px solid #333;
            border-radius: 4px;
            pointer-events: none;
            opacity: 0;
            font-size: 7px;
        }

        text {
            font-size: 4px;
            fill: black;
        }
    </style>
</head>

<body>
    <svg width="480" height="300"></svg>
    <div class="tooltip"></div>
    <script>
        const codeToState = {
            '01': 'AL',
            '02': 'AK',
            '04': 'AZ',
            '05': 'AR',
            '06': 'CA',
            '08': 'CO',
            '09': 'CT',
            '10': 'DE',
            '11': 'DC',
            '12': 'FL',
            '13': 'GA',
            '15': 'HI',
            '16': 'ID',
            '17': 'IL',
            '18': 'IN',
            '19': 'IA',
            '20': 'KS',
            '21': 'KY',
            '22': 'LA',
            '23': 'ME',
            '24': 'MD',
            '25': 'MA',
            '26': 'MI',
            '27': 'MN',
            '28': 'MS',
            '29': 'MO',
            '30': 'MT',
            '31': 'NE',
            '32': 'NV',
            '33': 'NH',
            '34': 'NJ',
            '35': 'NM',
            '36': 'NY',
            '37': 'NC',
            '38': 'ND',
            '39': 'OH',
            '40': 'OK',
            '41': 'OR',
            '42': 'PA',
            '44': 'RI',
            '45': 'SC',
            '46': 'SD',
            '47': 'TN',
            '48': 'TX',
            '49': 'UT',
            '50': 'VT',
            '51': 'VA',
            '53': 'WA',
            '54': 'WV',
            '55': 'WI',
            '56': 'WY'
        };

        const width = 480;
        const height = 300;

        const svg = d3.select("svg")
            .attr("width", width)
            .attr("height", height);

        const tooltip = d3.select(".tooltip");

        d3.json("https://d3js.org/us-10m.v1.json").then(us => {

            const states = topojson.feature(us, us.objects.states);

            const projection = d3.geoIdentity().fitSize([width, height], states);

            const path = d3.geoPath(projection);

            const statePaths = svg.append("g")
                .attr("class", "states")
                .selectAll("path")
                .data(states.features)
                .enter().append("path")
                .attr("class", "state")
                .attr("d", path)
                .attr("fill", "lightblue")
                .on("mouseover", function (event, d) {
                    console.log(d)
                    const stateName = `${codeToState[d.id]}<br>placeholder<br>placeholder`;
                    tooltip.style("opacity", .9);
                    tooltip.html(stateName)
                        .style("left", (event.pageX + 5) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mousemove", function (event) {
                    tooltip.style("left", (event.pageX + 5) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function () {
                    tooltip.style("opacity", 0);
                });

            svg.append("g")
                .attr("class", "labels")
                .selectAll("text")
                .data(states.features)
                .enter().append("text")
                .attr("class", "state-label")
                .attr("transform", function (d) {
                    return "translate(" + path.centroid(d) + ")";
                })
                .attr("dy", ".3em")
                .text(d => codeToState[d.id] || 'Unknown');
        });
    </script>
</body>

</html>